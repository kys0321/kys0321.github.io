---
title: Pandas에서 데이터 병합 기초
date: 2023-09-02 20:00:00 +0900
categories:
  - python
tags:
  - pandas
---

## 무엇이 문제인가?

Stackoverflow의 해당 질문에서는 `pandas` 라이브러리를 사용하여 데이터프레임을 병합(merge)하는 과정에서 발생하는 에러에 대한 해결책을 찾고 있습니다. 대부분의 사용자들은 `KeyError: 'key'`라는 오류에 직면하게 됩니다.

## KeyError: 'key' 오류 이해하기

`KeyError: 'key'` 오류는 병합할 두 데이터프레임 중 하나에 병합의 기준이 될 'key' 열이 없을 때 발생합니다. 예를 들어, 'A' 데이터프레임과 'B' 데이터프레임을 'id' 열을 기준으로 병합하려 했는데, 'A' 데이터프레임에는 'id' 열이 없다면 이 오류가 발생하게 됩니다.

## 해결 방법

### 기준 열 확인하기

먼저 병합을 수행하기 전에 두 데이터프레임의 열 이름을 확인합니다. 이는 `DataFrame.columns` 속성을 통해 쉽게 확인할 수 있습니다.

### 기준 열이 없을 경우

기준 열이 없을 경우 새로운 열을 생성하거나 기존의 다른 열을 사용할 수 있습니다. 예를 들어, 'A' 데이터프레임에 'id' 열이 없고, 'name' 열이 있다면 'name' 열을 기준으로 병합할 수 있습니다.

### 기존 열 이름 변경하기

열 이름이 서로 다르지만 같은 의미를 갖고 있다면, `DataFrame.rename()` 메소드를 사용해 열 이름을 변경한 후 병합할 수 있습니다.

## 예제 코드

두 데이터프레임 `df1`과 `df2`를 'id' 열을 기준으로 병합하는 예제 코드는 다음과 같습니다.

```python
import pandas as pd

df1 = pd.DataFrame({'id': [1, 2, 3], 'value': ['a', 'b', 'c']})
df2 = pd.DataFrame({'id': [1, 3, 4], 'value2': ['x', 'y', 'z']})

merged_df = pd.merge(df1, df2, on='id')
```

위의 코드를 실행하면 'id' 열을 기준으로 `df1`과 `df2`가 병합되며, 병합된 결과는 `merged_df`에 저장됩니다.

## 마무리

데이터 병합은 데이터 처리 과정에서 자주 발생하는 작업 중 하나입니다. 병합 과정에서 오류를 해결하기 위해서는 먼저 병합의 기준이 되는 열이 두 데이터프레임에 모두 존재하는지 확인하는 것이 중요합니다. 이를 통해 `KeyError: 'key'`와 같은 오류를 효과적으로 해결할 수 있습니다.